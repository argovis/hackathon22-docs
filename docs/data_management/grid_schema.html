

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Grid Schema &mdash; argovis  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Merging Argo Data" href="argo_merge.html" />
    <link rel="prev" title="Point Schema" href="point_schema.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> argovis
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_docs/point.html">Profiles API Beta Product</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_docs/grid.html">Grids API Beta Product</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Management</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="point_schema.html">Point Schema</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Grid Schema</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-to-read-this-schema">How to read this schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="#schema-enforcement-population">Schema enforcement &amp; population</a></li>
<li class="toctree-l2"><a class="reference internal" href="#grid-metadata-schema">Grid Metadata Schema</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#required-keys">Required keys</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#grid-data-schema">Grid Data Schema</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Required keys</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="argo_merge.html">Merging Argo Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix: Using Git &amp; Github</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_tools/pull_requests_and_github.html">Pull Requests, Git &amp; GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_tools/merge_conflicts.html">Dealing With Merge Conflicts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_tools/using_branches.html">Using Branches</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">argovis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Grid Schema</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/data_management/grid_schema.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="grid-schema">
<span id="id1"></span><h1>Grid Schema<a class="headerlink" href="#grid-schema" title="Permalink to this headline">¶</a></h1>
<p>This document describes the schema to which gridded Earth system data is cast in Argovis.</p>
<div class="section" id="how-to-read-this-schema">
<h2>How to read this schema<a class="headerlink" href="#how-to-read-this-schema" title="Permalink to this headline">¶</a></h2>
<p>Each entry in the schema fragments below contain a few keys:</p>
<ul class="simple">
<li><p><strong>type:</strong> the primitive type, format,  or object description of a valid entry for this field</p></li>
<li><p><strong>description:</strong> short comment on what this variable is</p></li>
<li><p><strong>fill value</strong> (optional): what this should be filled by if absent</p></li>
<li><p><strong>current vocabulary</strong> (optional): current set of possible values for this key,  with explanations as required.</p></li>
</ul>
</div>
<div class="section" id="schema-enforcement-population">
<h2>Schema enforcement &amp; population<a class="headerlink" href="#schema-enforcement-population" title="Permalink to this headline">¶</a></h2>
<p>All these schema are enforced via mongodb’s built-in schema validation; those schema validation rules are defined in the <code class="docutils literal notranslate"><span class="pre">grids.py</span></code> and <code class="docutils literal notranslate"><span class="pre">grids-meta.py</span></code> scripts at <a class="reference external" href="https://github.com/argovis/db-schema">https://github.com/argovis/db-schema</a>.</p>
<p>Once empty collections are generated by the script above, it is populated by pipelines that translate from the formats of upstream data providers, to mongodb-appropriate JSON that matches these schemas. Each section below contains links to the code backing these pipelines. Note that each gridded product lives in its own mongo collection at this time.</p>
</div>
<div class="section" id="grid-metadata-schema">
<h2>Grid Metadata Schema<a class="headerlink" href="#grid-metadata-schema" title="Permalink to this headline">¶</a></h2>
<p>In order to avoid repetition of information that is the same for all grid points, each grid in collection <code class="docutils literal notranslate"><span class="pre">&lt;grid</span> <span class="pre">name&gt;</span></code> will have a record in collection <code class="docutils literal notranslate"><span class="pre">grids-meta</span></code> with <code class="docutils literal notranslate"><span class="pre">_id=&lt;grid</span> <span class="pre">name&gt;</span></code> that carries all the metadata for that grid. The schema of <code class="docutils literal notranslate"><span class="pre">grids-meta</span></code> documents are described in this section.</p>
<p>Scripts for translating upstream data to these schema:</p>
<blockquote>
<div><ul class="simple">
<li><p>Roemmich-Gilson temperature and salinity: <a class="reference external" href="https://github.com/argovis/grid-sync/blob/main/translate-rg-grid.py">https://github.com/argovis/grid-sync/blob/main/translate-rg-grid.py</a></p></li>
</ul>
</div></blockquote>
<div class="section" id="required-keys">
<h3>Required keys<a class="headerlink" href="#required-keys" title="Permalink to this headline">¶</a></h3>
<p><em>Note all keys are required for metadata docs</em>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_id</span></code></p>
<ul>
<li><p><strong>type:</strong> string</p></li>
<li><p><strong>description:</strong> a string that matches the collection name that contains the data that should be associated with this metadata record</p></li>
<li><p><strong>current vocabulary</strong>: <code class="docutils literal notranslate"><span class="pre">rgTempTotal</span></code>, <code class="docutils literal notranslate"><span class="pre">rgPsalTotal</span></code>, <code class="docutils literal notranslate"><span class="pre">ohc</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">units</span></code></p>
<ul>
<li><p><strong>type:</strong> string</p></li>
<li><p><strong>description:</strong> the units of measure by which the <code class="docutils literal notranslate"><span class="pre">d</span></code> variables in the corresponding grids should be interpreted.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">levels</span></code></p>
<ul>
<li><p><strong>type:</strong> array of floats</p></li>
<li><p><strong>description:</strong> the pressures in dbar of all levels of this grid, in the same order as the <code class="docutils literal notranslate"><span class="pre">d</span></code> record of the corresponding grid data.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">date_added</span></code></p>
<ul>
<li><p><strong>type:</strong> ISO 8601 UTC datestring,  example <code class="docutils literal notranslate"><span class="pre">1999-12-31T23:59:59Z</span></code></p></li>
<li><p><strong>description:</strong> time the record was added to Argovis</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">lonrange</span></code></p>
<ul>
<li><p><strong>type:</strong> array of floats</p></li>
<li><p><strong>description</strong>: minimum and maximum longitudes, in degrees, found in this grid</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">latrange</span></code></p>
<ul>
<li><p><strong>type:</strong> array of floats</p></li>
<li><p><strong>description:</strong> minimum and maximum latitudes, in degrees, found in this grid</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">timerange</span></code></p>
<ul>
<li><p><strong>type:</strong> array of ISO 8601 UTC datestring</p></li>
<li><p><strong>descriptionL</strong> minimum and maximum dates found in this grid</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">loncell</span></code></p>
<ul>
<li><p><strong>type:</strong> float</p></li>
<li><p><strong>description:</strong> grid spacing in degrees in longitude</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">latcell</span></code></p>
<ul>
<li><p><strong>type:</strong> float</p></li>
<li><p><strong>description:</strong> grid spacing in degrees in latitude</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="grid-data-schema">
<h2>Grid Data Schema<a class="headerlink" href="#grid-data-schema" title="Permalink to this headline">¶</a></h2>
<p>Each gridded product is stored in its own collection, the name of which has a corresponding entry in the <code class="docutils literal notranslate"><span class="pre">grids-meta</span></code> collection. Documents in the gridded data collections obey the following schema, which describe a profile-like column of a grid.</p>
<p>Scripts for translating upstream data to these schema:</p>
<blockquote>
<div><ul class="simple">
<li><p>Roemmich-Gilson temperature and salinity: <a class="reference external" href="https://github.com/argovis/grid-sync/blob/main/translate-rg-grid.py">https://github.com/argovis/grid-sync/blob/main/translate-rg-grid.py</a></p></li>
</ul>
</div></blockquote>
<div class="section" id="id2">
<h3>Required keys<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p><em>Note all keys are required for gridded docs</em>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">g</span></code></p>
<ul>
<li><p><strong>type:</strong> geojson Point object</p></li>
<li><p><strong>description:</strong> geojson Point tagging the lon/lat of this record.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code></p>
<ul>
<li><p><strong>type:</strong> ISO 8601 UTC datestring,  example <code class="docutils literal notranslate"><span class="pre">1999-12-31T23:59:59Z</span></code></p></li>
<li><p><strong>description:</strong> time this data corresponds to.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code></p>
<ul>
<li><p><strong>type:</strong> array of floats</p></li>
<li><p><strong>description:</strong> the variable data for this column of the grid. These entries correspond in order to the <code class="docutils literal notranslate"><span class="pre">levels</span></code> array in the corresponding metadata document which describes their depth, and carry the units of the <code class="docutils literal notranslate"><span class="pre">units</span></code> entry in the same metadata document.</p></li>
</ul>
</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="argo_merge.html" class="btn btn-neutral float-right" title="Merging Argo Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="point_schema.html" class="btn btn-neutral float-left" title="Point Schema" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Argovis Collaboration.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>